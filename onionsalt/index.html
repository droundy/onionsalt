<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `onionsalt` crate.">
    <meta name="keywords" content="rust, rustlang, rust-lang, onionsalt">

    <title>onionsalt - Rust</title>

    <link rel="stylesheet" type="text/css" href="../main.css">

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <section class="sidebar">
        
        <p class='location'></p><script>window.sidebarCurrent = {name: 'onionsalt', ty: 'mod', relpath: '../'};</script>
    </section>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Crate <a class='mod' href=''>onionsalt</a></span><span class='out-of-band'><span id='render-detail'>
            <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                [<span class='inner'>&#x2212;</span>]
            </a>
        </span><a id='src-0' class='srclink' href='../src/onionsalt/lib.rs.html#1-836' title='goto source code'>[src]</a></span></h1>
<div class='docblock'><p>The onionsalt crate.</p>

<p>The Onion Salt encryption scheme is an onion encryption scheme
that is closely derived from the NaCl <code>crypto_box</code> format.</p>

<h1 id="examples" class='section-header'><a
                           href="#examples">Examples</a></h1>
<p>Here is a simple example of onion encrypting a message and
decrypting it.</p>
<pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>pairs</span> <span class='op'>=</span> [<span class='ident'>crypto</span>::<span class='ident'>box_keypair</span>(),
             <span class='ident'>crypto</span>::<span class='ident'>box_keypair</span>(),
             <span class='ident'>crypto</span>::<span class='ident'>box_keypair</span>(),
             <span class='ident'>crypto</span>::<span class='ident'>box_keypair</span>(),
             <span class='ident'>crypto</span>::<span class='ident'>box_keypair</span>(),
             <span class='ident'>crypto</span>::<span class='ident'>box_keypair</span>()];
<span class='kw'>let</span> <span class='ident'>recipient</span> <span class='op'>=</span> <span class='number'>2</span>;
<span class='kw'>let</span> <span class='ident'>recipient_key</span> <span class='op'>=</span> <span class='ident'>pairs</span>[<span class='ident'>recipient</span>].<span class='ident'>clone</span>();
<span class='kw'>let</span> <span class='ident'>keys_and_routes</span>: [(<span class='ident'>crypto</span>::<span class='ident'>PublicKey</span>, [<span class='ident'>u8</span>; <span class='ident'>ROUTING_LENGTH</span>]); <span class='ident'>ROUTE_COUNT</span>]
                       <span class='op'>=</span> [(<span class='ident'>pairs</span>[<span class='number'>0</span>].<span class='ident'>public</span>, <span class='op'>*</span><span class='string'>b&quot;address for 0 router    &quot;</span>),
                          (<span class='ident'>pairs</span>[<span class='number'>1</span>].<span class='ident'>public</span>, <span class='op'>*</span><span class='string'>b&quot;the address for router 1&quot;</span>),
                          (<span class='ident'>pairs</span>[<span class='number'>2</span>].<span class='ident'>public</span>, <span class='op'>*</span><span class='string'>b&quot;this is the recipient!!!&quot;</span>),
                          (<span class='ident'>pairs</span>[<span class='number'>3</span>].<span class='ident'>public</span>, <span class='op'>*</span><span class='string'>b&quot;the next router is nice.&quot;</span>),
                          (<span class='ident'>pairs</span>[<span class='number'>4</span>].<span class='ident'>public</span>, <span class='op'>*</span><span class='string'>b&quot;the second-to-last node.&quot;</span>),
                          (<span class='ident'>pairs</span>[<span class='number'>5</span>].<span class='ident'>public</span>, <span class='op'>*</span><span class='string'>b&quot;This is my own address. &quot;</span>)];
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>payload</span>: [<span class='ident'>u8</span>; <span class='ident'>PAYLOAD_LENGTH</span>] <span class='op'>=</span> [<span class='number'>0</span>; <span class='ident'>PAYLOAD_LENGTH</span>];
<span class='ident'>payload</span>[<span class='number'>3</span>] <span class='op'>=</span> <span class='number'>3</span>;
<span class='kw'>let</span> <span class='ident'>payload</span> <span class='op'>=</span> <span class='ident'>payload</span>;
<span class='kw'>let</span> <span class='ident'>our_personal_key</span> <span class='op'>=</span> <span class='ident'>crypto</span>::<span class='ident'>box_keypair</span>();
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>ob</span> <span class='op'>=</span> <span class='ident'>onionbox</span>(<span class='kw-2'>&amp;</span><span class='ident'>keys_and_routes</span>, <span class='ident'>recipient</span>).<span class='ident'>unwrap</span>();
<span class='ident'>ob</span>.<span class='ident'>add_payload</span>(<span class='ident'>our_personal_key</span>, <span class='kw-2'>&amp;</span><span class='ident'>payload</span>);

<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>packet</span> <span class='op'>=</span> <span class='ident'>ob</span>.<span class='ident'>packet</span>();
<span class='kw'>let</span> <span class='ident'>response</span> <span class='op'>=</span> [<span class='number'>1</span>; <span class='ident'>PAYLOAD_LENGTH</span>];
<span class='kw'>for</span> <span class='ident'>i</span> <span class='kw'>in</span> <span class='number'>0</span>..<span class='number'>6</span> {
    <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;opening box {}&quot;</span>, <span class='ident'>i</span>);
    <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>oob</span> <span class='op'>=</span> <span class='ident'>onionbox_open</span>(<span class='kw-2'>&amp;</span><span class='ident'>packet</span>, <span class='kw-2'>&amp;</span><span class='ident'>pairs</span>[<span class='ident'>i</span>].<span class='ident'>secret</span>).<span class='ident'>unwrap</span>();
    <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;grabbing routing for {}&quot;</span>, <span class='ident'>i</span>);
    <span class='kw'>let</span> <span class='ident'>routing</span> <span class='op'>=</span> <span class='ident'>oob</span>.<span class='ident'>routing</span>();
    <span class='comment'>// routing now holds the routing information sent to &quot;i&quot;</span>
    <span class='kw'>if</span> <span class='ident'>i</span> <span class='op'>==</span> <span class='ident'>recipient</span> {
        <span class='comment'>// This is how to attach a response if you are the recipient.</span>
        <span class='ident'>oob</span>.<span class='ident'>respond</span>(<span class='kw-2'>&amp;</span><span class='ident'>recipient_key</span>, <span class='kw-2'>&amp;</span><span class='ident'>response</span>);
    }
    <span class='ident'>packet</span> <span class='op'>=</span> <span class='ident'>oob</span>.<span class='ident'>packet</span>();
}
<span class='kw'>let</span> <span class='ident'>resp</span> <span class='op'>=</span> <span class='ident'>ob</span>.<span class='ident'>read_return</span>(<span class='ident'>our_personal_key</span>, <span class='kw-2'>&amp;</span><span class='ident'>packet</span>).<span class='ident'>unwrap</span>();
<span class='comment'>// resp now holds the return message, authenticated and decrypted.</span></pre>
</div><h2 id='modules' class='section-header'><a href="#modules">Modules</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='mod' href='creatediagrams/index.html'
                               title='onionsalt::creatediagrams'>creatediagrams</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='mod' href='crypto/index.html'
                               title='onionsalt::crypto'>crypto</a></td>
                        <td class='docblock short'>
                             <p>A rust translation of the TweetNaCl library.  It is mostly a
direct translation, but in places I tried to make the API more
rustic.  It has three major features, of which you are likely
to use only one.</p>

                        </td>
                    </tr>
                </table><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.OnionBox.html'
                               title='onionsalt::OnionBox'>OnionBox</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.OpenedOnionBox.html'
                               title='onionsalt::OpenedOnionBox'>OpenedOnionBox</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                </table><h2 id='constants' class='section-header'><a href="#constants">Constants</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='constant' href='constant.ENCRYPTEDPAYLOAD_LENGTH.html'
                               title='onionsalt::ENCRYPTEDPAYLOAD_LENGTH'>ENCRYPTEDPAYLOAD_LENGTH</a></td>
                        <td class='docblock short'>
                             <p>The size of an encrypted payload.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='constant' href='constant.PACKET_LENGTH.html'
                               title='onionsalt::PACKET_LENGTH'>PACKET_LENGTH</a></td>
                        <td class='docblock short'>
                             <p><code>PACKET_LENGTH</code> is the size that we actually send to each recipient.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='constant' href='constant.PAYLOAD_LENGTH.html'
                               title='onionsalt::PAYLOAD_LENGTH'>PAYLOAD_LENGTH</a></td>
                        <td class='docblock short'>
                             <p><code>PAYLOAD_LENGTH</code> is the size of the payload that the primary
recipient can get.  It differs from <code>ENCRYPTEDPAYLOAD_LENGTH</code> by 48
(or <code>OVERHEADBYTES</code>).</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='constant' href='constant.ROUTE_COUNT.html'
                               title='onionsalt::ROUTE_COUNT'>ROUTE_COUNT</a></td>
                        <td class='docblock short'>
                             <p>The number of routers we send through.  Eventually I want to
implement the feature to send through fewer routers with the
message arriving back early.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='constant' href='constant.ROUTING_LENGTH.html'
                               title='onionsalt::ROUTING_LENGTH'>ROUTING_LENGTH</a></td>
                        <td class='docblock short'>
                             <p>The ROUTING_LENGTH is big enough for an ipv6 address and some
extra information.</p>

                        </td>
                    </tr>
                </table><h2 id='functions' class='section-header'><a href="#functions">Functions</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='fn' href='fn.onionbox.html'
                               title='onionsalt::onionbox'>onionbox</a></td>
                        <td class='docblock short'>
                             <p>Encrypt a message in an onion defined by <code>keys_and_routings</code>, with
<code>payload</code> directed to <code>payload_recipient</code>.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='fn' href='fn.onionbox_open.html'
                               title='onionsalt::onionbox_open'>onionbox_open</a></td>
                        <td class='docblock short'>
                             <p>The message is passed in <code>input</code>, and a struct is returned which
has methods to access the decrypted routing information, the
decrypted message (to be passed to the next router), to access the
payload, and to insert an encrypted response to the payload.</p>

                        </td>
                    </tr>
                </table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <div id="help" class="hidden">
        <div>
            <div class="shortcuts">
                <h1>Keyboard Shortcuts</h1>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                </dl>
            </div>

            <div class="infos">
                <h1>Search Tricks</h1>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>typedef</code> (or
                    <code>tdef</code>).
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code>)
                </p>
            </div>
        </div>
    </div>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "onionsalt";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script async src="../search-index.js"></script>
</body>
</html>